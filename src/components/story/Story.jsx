import React from 'react';
import { Box, Stack } from '@mui/system';
import { URL } from 'url';
import { useState, useEffect } from 'react';
import { GetTranslation } from '../../util/DeepLApi';
import './story.css'
import { Divider } from '@mui/material';

const story3 = `Vosotros dos podéis ir en busca de vuestra gran aventura —dijo Ari—. ¡Pero yo me quedo en casa!

—Eso sí que no. ¡Vienes con nosotros!

Desa trató de levantar a su amigo. Ari le pateó la rodilla. Lo bajó.

Ari tenía 80 años. Sin embargo, no era humano. Ari era un esligo con cabello largo y blanco. Tenía los dedos largos y arrugados.

Ari era muy joven... para ser esligo. Comparado con los humanos, era un adolescente.

—No, me quedo en casa —repitió Ari—. No cambiaré de opinión. No quiero salir. No quiero ir a buscar un tesoro y no quiero pelear con nadie. ¡Vosotros podéis quedaros con vuestra aventura!

Desa alzó los brazos peludos.

—¡Me rindo! —dijo.

También era esliga, pero era divertida y muy ruidosa. La mayoría de los esligos no eran así.

Su otro amigo era brilli. A los brillis les encantaba pelear, les encantaba la aventura, y sobre todo les encantaba buscar oro y tesoros.

Lo que más les gustaba en el mundo eran los tesoros.

El brilli se llamaba Lumu. Nadie sabía cuántos años tenía Lumu. Le gustaba hablar mucho, pero nadie le entendía. No hablaba el idioma de los esligos, pero podía escribirlo.

Lumu llevaba una libreta. A veces, escribía cosas allí.

Escribió una nota a Ari.

—Ari —decía la nota—, te puedes quedar en casa.

—Gracias —dijo Ari—. ¿Ves? Lumu está de acuerdo conmigo.

Lumu escribió: «No estoy de acuerdo». Señaló hacia la ventana. A lo lejos había una nube de polvo. Se acercaban unos caballos. Ari vio humanos sobre los caballos. ¡Humanos! Uno de los hombres vestía un abrigo largo y amarillo. Tenía una corona en la cabeza

—No tenemos que irnos para tener una aventura —dijo Desa con una sonrisa—. ¡La aventura está viniendo hacia nosotros!

* * *

Ari, Desa y Lumu corrieron hacia afuera. En el pueblo, todos estaban afuera. El pueblo era pequeño. Se llamaba Cañada de las Aves. Era muy tranquilo. La mayoría de las personas que vivían en Cañada de las Aves eran esligos, pero también había algunos brillis y algunas personas de otro tipo.

Todos estaban parados frente a sus casas. Estaban mirando a los humanos sobre los caballos.

No era común recibir visitantes. Nunca veían desconocidos, y estos desconocidos vestían ropa muy rara.

Los caballos bajaron la velocidad. El primer caballo era una yegua negra y grande. El jinete era el hombre alto con el abrigo amarillo. Tenía una corona en la cabeza. Parecía un rey cansado.

Tocó el cuello de su caballo y el caballo se quedó quieto. El jinete descendió. Parecía el líder de los otros hombres.

—¿Alguno de vosotros sabe quién soy? —preguntó en español. Los otros jinetes se quedaron sobre los caballos. Había ocho en total, incluido el líder.

—¿Por qué no nos dices? —preguntó un esligo menudo. Era Pidor, el panadero. Como la mayoría de los esligos, Pidor recordaba el español antiguo—. ¡Aquí no nos gustan los misterios, humano!

Desa dio un paso adelante.

—¿Eres un rey del este? —preguntó.

—¿Por qué piensas que soy un rey?

Desa señaló la corona.

El hombre alto vestido de amarillo se quitó la corona de la cabeza.

—Tal vez la he robado —dijo.

Tenía ojos azules brillantes y una barba larga y rojiza.

Lumu admiraba la corona. Estaba hecha de oro. Debía ser pesada... y costar mucho dinero.

—Si la robaste —dijo Pidor—, debes ir a devolverla. Aquí no nos gustan los ladrones.

—¿Y qué os gusta? —preguntó el hombre—. ¿Os gusta algo?

—Nos gusta que nos dejéis tranquilos. Pidor cruzó los brazos. Uno de los otros jinetes se le acercó. El líder agitó la mano.

—No —dijo el líder—. Dadle al viejo esligo lo que quiere. Dejadle tranquilo. Miró otra vez a Desa.

—Casi tienes razón. Yo era un rey. Ya no lo soy.

Dejó caer la corona al suelo.

Lumu escribió una nota. Se la mostró a Desa.

La nota decía: «Pregúntale si puedo coger la corona ahora».

Desa negó con la cabeza. No le prestó atención a Lumu.

—¿Qué pasó? —le preguntó al antiguo rey—. ¿Y por qué habéis venido a Cañada de las Aves?

Los otros jinetes detuvieron los caballos. Todos descendieron. Se pararon junto a su rey.

—Estos hombres —dijo— son los últimos humanos. Hubo una guerra muy grande en el este. Todos murieron. Ya no soy rey... porque ya no hay a quién gobernar.

—Entonces, ¿para qué habéis venido? —preguntó Pidor. Detrás de él, su mujer escondía a sus hijas.

—No temas por tus hijas —dijo el líder, rascándose la barba rojiza—. Me llamo Iardo. Estoy llevando a estos siete hombres al pueblo de Manantiales, junto al mar, pero estamos perdidos.

—Me llamo Desa. Necesitas un guía —dijo Desa, y dio un paso hacia adelante.

—Sí, es verdad que necesito un guía —dijo Iardo—. No tengo dinero, pero tengo esta corona de oro. Se la daré a quien nos ayude.

Ari tenía una duda.

—¿Por qué debéis ir a Manantiales? ¿Qué os espera allí?

—Existe un rumor que dice que mis amigos están allí. Tal vez no somos los últimos humanos. Necesito saberlo, ¡por eso estamos buscándolos!

Lumu le escribió una nota a Desa. Quería ir porque quería la corona. Desa asintió con la cabeza. Ella también deseaba hacer el viaje.

—Te ayudaremos —dijo.

Ari parecía asustado. No podía permitirle a Desa que se fuera con estos desconocidos. Le susurró algo en esligonio, pero Desa negó con la cabeza.

—Yo voy —le dijo—. ¡Ven con nosotros!

Iardo y sus hombres esperaban la respuesta de Ari.

—Yo solo quiero quedarme en casa —dijo Ari—. Pero iré con vosotros.

«Iré para protegerte, Desa», pensó.

Uno de los jinetes que tenía una cicatriz en la frente se inclinó y recogió la corona. Le quitó el polvo y la puso en una alforja, luego volvió a montarse al caballo.

—Entonces, tenemos un trato —dijo Iardo—. Tú —señaló a Lumu— montarás con Sadido, el que tiene la cicatriz. Por ahora, él guardará la corona—. Tú —señaló a Ari— montarás con el gordo Ekin, el que está allí atrás. Y tú, Desa, puedes montar conmigo.

`

const story2 = `Alemania, en la Segunda Guerra Mundial...

—¡Ríndete ya! —gritó una voz en alemán. Estaba afuera. El motor del yip hacía mucho ruido, pero él gritaba más fuerte—. ¡Sal o abriremos fuego!

Lily no miró por la ventana rota. Estaba dentro de un edificio viejo. El edificio estaba rodeado de soldados nazi. Si no se rendía, le dispararían. ¡Seguirían disparando hasta tirar abajo el edificio!

—¡Está bien! —gritó—. Estaba escondida en un rincón de una habitación oscura. A su lado tenía un bolso marrón. Dentro del bolso había un secreto, y su trabajo era mantenerlo a salvo—. ¡Voy a salir! ¡Voy a salir por la puerta principal!

Esperó y escuchó.

—¡Levanta las manos! ¡Pon las manos en el aire o te dispararemos! —dijo el soldado—. ¡Si tienes algo en las manos, te dispararemos!

«Quieren dispararme de veras», pensó Lily y revisó su pistola. «Yo también quiero dispararles a varios nazis. Mataron a mi compañero...»

No había tiempo de pensar en el pasado. Lily no tenía tiempo para emociones en este momento.

Era una profesional. Tenía un trabajo que hacer.

Rendirse no era parte de su plan.

Se ató el cabello rojo en una coleta. Cruzó la habitación arrastrándose sobre las manos y las rodillas. Se movió hacia el final del pasillo. Fue hacia la puerta trasera.

—¡Sal! ¡Tienes cinco segundos!

«Si salgo, me matarás», pensó. De repente, giró hacia la izquierda y se alejó de la puerta trasera. Frente a ella había una pequeña puerta de madera. Llevaba hasta el sótano.

La abrió y bajó corriendo las escaleras. «Saben que existe este sótano, ¡pero no saben que termina en un túnel!»

Por encima de su cabeza, podía oír el sonido potente de los disparos... estaban disparando al edificio con ametralladoras. Iban a destruir el edificio.

Lily sabía que los soldados tenían órdenes de no matarla, pero estaban tratando de matarla. Sabían que era peligrosa.

«Alguien les dijo quién soy. Tenía una identidad secreta, pero eso ya no existe.

Ahora todos los nazis de Alemania me quieren muerta... excepto los que mandan. Los jefes me quieren viva. Quieren hacerme preguntas…»

El sótano olía mal. No estaba muy iluminado; solamente tenía una bombilla vieja. Frente a la bombilla había una alfombra vieja. Colgaba desde el techo. Lily tiró de la alfombra. Detrás de la alfombra, había un hoyo grande.

¡El túnel!

Iba a escapar a través del túnel... ¿pero qué había del otro lado? No lo sabía. ¿Tal vez la esperaba alguien?

El fuego paró. También paró el sonido del yip. El líder de los soldados alemanes estaba gritando. Hablaba alemán. Lily sabía alemán y entendía lo que estaba diciendo.

—¡Entrad! ¡No salgáis hasta que la encuentren! ¡Buscad también en el sótano!

«Tengo que irme», decidió Lily. Quitó la bombilla. El sótano y el túnel estaban completamente oscuros. No le importaba. Lily Z. Bernhart era la espía más grande de los Estados Unidos. Había terminado treinta y ocho misiones. Siempre había tenido éxito en sus misiones.

Y no le tenía miedo a la oscuridad.

* * *

Tres horas más tarde...

Lily estaba en un café en Berlín. Estaba fumando un cigarro. Observó a un mozo flaco que pasó junto a ella. La estaba ignorando. ¿Por qué la ignoraba? Tenía cabello rojizo y su cara era la de una extranjera.

Tal vez no le gustaban los extranjeros.

—¡Disculpe! —dijo en alemán—. ¿No me ve?

La mayoría de los días, a Lily no le gustaba llamar la atención. Era una espía profesional. Lily no se ponía ropa elegante. No manejaba coches veloces.

Era muy saludable, pero no tenía apariencia de modelo.

A veces, alguna persona le preguntaba su nombre. Nunca decía: «Bernhart. Lily Bernhart».

El gobierno le había dado una docena de nombres falsos. No tenía motivo para usar su nombre verdadero.

Normalmente, actuaba con timidez. Pero quería que le sirvan. Tenía sed y necesitaba una bebida.

—¡Disculpe! —repitió.

—¿Sí? ¿Qué desea? —preguntó el camarero. No había muchos clientes. El café no estaba ocupado.

—Tráigame un café y un pastel de manzana.

Se dio la vuelta y fue detrás del mostrador. Sirvió el café. Puso el pastel sobre un plato. Luego Lily lo vio entrar otra vez a la cocina.

«¿Por qué está yendo a la cocina? ¡Todo lo que necesito está aquí, en el mostrador!»

Sabía por qué se había ido. Quería usar el teléfono. Iba a llamar a los soldados. Iba a decir: «¡la señora de cabello rojizo está aquí!»

Lily trató de no pensar. «¡Qué tonta soy!», se dijo a sí misma.

Luego lo vio. La estaba mirando desde la ventana de la cocina.

«Parece que tiene la nariz quebrada», pensó.

El mozo flaco le trajo su café y un pastel. Los puso sobre la mesa.

Ella se dio cuenta de que estaba sudando.

Hacía frío. ¿Por qué estaba sudando? ¿Estaba nervioso? El camarero se limpió el sudor con la manga de la camisa.

—¿Desea algo más?

—No —dijo, tomando su café. El café estaba frío.

—¿Es turista? Su alemán es muy bueno— dijo. Trató de sonreír, pero era una sonrisa falsa.

Lily negó con la cabeza y observó la nariz quebrada.

—Vivo aquí. He vivido aquí muchos años.

El camarero observaba su bolso.

«Algo no está bien», pensó Lily. «Primero me ignoró. Ahora, me está prestando demasiada atención».

—Por favor, hágame saber si necesita algo más, ¿señorita...?

—Bolan. Nellie Bolan.

El camarero se fue.

«Me estoy poniendo paranoica», pensó. Encendió un cigarro.

Fumar no era un buen hábito, pero su trabajo era peligroso. Había demasiadas cosas para preocuparse. Fumar era malo, pero había cosas peores como otros espías, los soldados nazi y la gente que ayudaba a los nazis...

Lily casi terminaba su pastel. Escuchó un sonido conocido: el sonido del motor de un yip.

¡Los soldados estaban aquí!

Se paró con rapidez. El camarero estaba delante de la puerta de la cocina. Lily cogió su bolso marrón y el tenedor. Empujó la mesa. Corrió hacia el camarero. Sostenía el tenedor delante de ella.

El camarero flaco saltó para moverse de su camino. Lily corrió a través de la cocina. Se escapó por la puerta trasera del café.

Desapareció en la noche, pero sabía que los soldados la seguirían. `



const story1 = `Capítulo 3

Esperé tres días antes de llamarla. Fueron tres días muy largos. Fue difícil esperar.

—Tú pierdes —dijo Catalina al contestar el teléfono.

—No apostamos, ¿recuerdas? Me preguntaba... ¿qué vas a hacer esta noche?

Catalina hizo silencio. Por un momento no dijo nada.

—Mis padres darán una fiesta pequeña en casa. Recibirán a algunos socios de su negocio. Quieren hablar sobre el club nocturno. Les interesa saber si le está yendo bien.

—¿Irás a la fiesta? —pregunté.

—Sí, porque quieren mi opinión. Desean conocer la opinión de una persona joven. ¡Quizás deberías venir tú también!

Me reí.

—¡No! ¿Deseas que conozca a tus padres? ¿Y quieres que les dé mi opinión sobre su club?

Catalina no se rio conmigo.

—Sí, quiero que vengas. ¿Por qué no? Me parece que eres una persona muy honesta...

—¡Pero no me conoces!

—Las mujeres tenemos intuición sobre las personas, Juan. ¿Podemos encontrarnos a las ocho?

* * *

Nos encontramos fuera de su apartamento. Fuimos en su coche hasta la casa de sus padres. La casa era una mansión gigante. Tenía dos pisos y veinte habitaciones. Conté las ventanas.

—¿Qué estás haciendo? —me preguntó. Condujo el coche sobre la entrada grande.

—Estoy contando las ventanas.

—¿Por qué?

—No sé. Estoy tratando de ver dónde está el cuarto de baño.

«Qué cosa más tonta para decir», pensé. Nunca antes había estado en la casa de una persona rica. Ahora iba a cenar con personas ricas que no conocía. ¡Las personas que no conocía eran los padres de esta chica!

Tenía un buen motivo para estar nervioso.

—No te pongas nervioso —dijo. Estaba bajando del coche—. Solo sé tú mismo.

—¿Qué significa eso? ¡Todos dicen eso siempre! «Sé tú mismo, sé tú mismo». ¡Por supuesto que voy a ser yo mismo!

—Está bien, no te preocupes —dijo. Cerró la puerta del coche con fuerza—. Estás actuando raro. Mejor que seas alguien más.

—Lo siento. Es una noche extraña. No sé qué hablar con tus padres.

Golpeó a la puerta. Abrió un mayordomo. ¡Un mayordomo!

—Hola, Jaime —dijo.

«¡Tu mayordomo no puede llamarse Jaime!», quería decirle.

—Muy gracioso, jovencita. Pasa. Y bienvenido, ¿señor...?

—Buenas noches, soy Juan Cruz —dije. Extendí la mano.

El mayordomo me estrechó la mano. Me dijo que su verdadero nombre era Pedro, no Jaime. Nos llevó hacia una sala de estar amplia. Había una docena de personas sentadas en sofás. Dos de ellos se pusieron de pie. Caminaron hacia donde estábamos Catalina y yo.

—Hola, cariño —dijo una mujer muy guapa. Se parecía a Catalina, pero era mayor—. ¿Este es tu nuevo amigo? Hola, soy Zara.

—Soy Juan —dije y extendí otra vez la mano. Ella no me estrechó la mano. En cambio, me dio un gran abrazo. Un hombre apuesto con cabello gris estaba parado a su lado.

—A mi esposa le gustan los abrazos —dijo—. Pero yo te estrecharé la mano. Estrechaba la mano con la fuerza de Supermán—. Puedes llamarme Ismael.

Recordé la broma sobre el nombre de mayordomo. Pensé que él también me estaba haciendo una broma.

—¿Ismael? ¡Qué gracioso! No me vais a engañar otra vez —dije.

—No, no es una broma —dijo Catalina—. El nombre de mi padre es Ismael.

Zara rio a carcajadas.

—Me gusta tu amigo, Catalina —dijo—. Por favor siéntate, Juan. Conversemos.

* * *

Conversamos durante algunos minutos en la sala de estar. Luego pasamos al comedor. La cena comenzó con un gazpacho delicioso. Después de la cena, comenzamos a hablar sobre el negocio del club nocturno.

—¿Cuál fue tu impresión del lugar? —preguntó Zara.

—¿Mi impresión? Bueno, lo primero que vi fue el gorila. No fue grosero, pero me parece que su lista de reservaciones no es real.

—¿Te parece que la lista de reservaciones es falsa? ¿Por qué piensas eso?

Catalina y yo nos miramos y sonreímos.

—Yo le dije que no era real —dijo Catalina.

—Mucha gente quiere entrar al club —dijo Zara. Movía su collar de perlas alrededor del cuello de la camisa—. Tenemos que ser cuidadosos. No podemos dejar entrar a todos. No hay suficiente espacio para todos.

—Existe otro motivo —dijo el padre de Catalina—. Algunas personas quieren entrar pero no quieren gastar dinero. Otras personas vienen a gastar dinero. Es un negocio. Queremos clientes con dinero.

—¿Qué opinas del interior? —preguntó Zara—. ¿Te gustó?

Me acordé del pobre barman. Estaba tratando de ayudar a demasiados clientes. Yo también había sido barman. Sabía que era un trabajo difícil.

—Me gustó el interior, pero necesita otro barman —dije—. Ese tío necesitaba ayuda. Tenía demasiados clientes. Había una multitud. Me dio pena.

—¿Conoces a algún barman? ¿Conoces a alguien que necesite trabajo? —preguntó Catalina. Zara e Ismael esperaban mi respuesta.

—Ejem, sí. Conozco un barman que necesita trabajo—dije—. Y no cobra mucho.

* * *

Al final de la semana, ya tenía un nuevo trabajo: ¡en el club nocturno Zara! Mi novia, Catalina, me visitaba a menudo. Me hice amigo del otro barman, Diego. También me hice amigo de Bruno, el gorila.

—No puedo creerlo. Tienes suerte, Juan —dijo Arón una noche, negando con la cabeza.

—¿Suerte? —pregunté. Arón estaba sentado solo. A su lado estaban Nacho y la nueva novia de Nacho, Alicia—. Estás equivocado, chaval. La suerte no fue el motivo. La suerte no tuvo nada que ver. Fue perseverancia. En esta vida, la perseverancia es la única forma de conseguir algo.

—Por suerte —dijo Catalina y me cogió de la mano—, ¡Juan tiene mucha perseverancia!

 
     `

// const words = ['andando', 'primera', 'comerciante','rocas' ]



const Story = () => {
  const [words, setWords] = useState(['Add new words here' ]);
  const  [activeStory, setactiveStory] = useState(1);
    
  // const [translationInput, setTranslationInput] = useState('Mi nombre es Valor. Soy un comerciante de tierras muy lejanas. Siempre comercio con diferentes productos en diferentes ciudades. Normalmente, viajo mucho.');
  const [translationOutput, setTranslationOutput] = useState('');
  const [wordHighlighted, setWordHighlighted] = useState('second');
  const inputLanaguage = 'ES';
  const outputLanaguage = 'EN'


  
  const handleTranslate = async (translationInput) => {
    if (translationInput.split(' ').length >  1) {
        setTranslationOutput(await GetTranslation(translationInput, inputLanaguage, outputLanaguage )) 
    } else {
      setWordHighlighted(`${translationInput} : ${await GetTranslation(translationInput, inputLanaguage, outputLanaguage )}`) 

    }
  }

  // const [highlightedText, setHighlightedText] = useState(
  //   'Highlight a word or phrase and the translation will appear here'
  // );




  useEffect(() => {
    const saveSelection = () => {
      const highlightedText = (window.getSelection().toString());
        handleTranslate(highlightedText)  
    };
    document.addEventListener('mouseup', saveSelection);
    return () => document.removeEventListener('mouseup', saveSelection);
  }, []);

  //Function to add transalted word to list of words
  const addList = () => {
    setWords([...words , wordHighlighted ])

  }


  



  return (

    <Box p = {3} >
      <h2 className='heading' align = 'center'>Story</h2>
      <p className='story'>
        Story is designed to help you learn vocabulary and reinfroce
        your understanding of grammar topics. Read the story and highlight any phrases or words you don't understand and they will be translated instantly. 
        For new words you can add them to the list so that you can review all the new vocabulary when you're finished. 
      </p>

      <Stack paddingBottom={2} direction = 'row' spacing={2} justifyContent = 'center' >
        <button onClick = {() => setactiveStory(1)} className='button'>Story 1 </button>
        <button onClick = {() => setactiveStory(2)} className='button'>Story 2 </button>
        <button onClick = {() => setactiveStory(3)}className='button'>Story 3 </button>
      </Stack>
      <Stack direction = {{xs: "column", sm: 'row'}} maxHeight = {{xs: '700px', sm: '1500px'}} className = 'section-container' spacing = {4} divider={<Divider orientation="vertical" flexItem />}>
        <Box height='400px' sx = {{ overflowY: 'scroll'}} flex = {1}>
          <p className='story2'>
            <h4>Story {activeStory}</h4>
            {activeStory == 1 ? <p>{story1}</p>: activeStory == 2 ? <p>{story2}</p>: <p>{story3}</p> }
            
          </p>
        </Box>

        <Stack  flex={0.7}>
          <Box p = {0.5}>
            <h4>Translation Here</h4>
            <p className='story'>{translationOutput}</p>
            <p></p>
             

          </Box>

          <Box>

            
            
            <h4>List of words here</h4>
            <p>Highlighted word : {wordHighlighted}</p>
            <button onClick = {addList} className='button'>Add to list</button>
            <ul>
            {words.map((word) => {
              return (<li>{word}</li>)
            })} 
            </ul>
          </Box>
        </Stack>
      </Stack>

    </Box>
  )
}

export default Story


// will have a story in spanish where the user can hightlight a word for that words meaning and conjugatiosn or pharse to be translated